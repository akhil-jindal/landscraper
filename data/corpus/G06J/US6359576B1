Apparatus and methods for performing RMS-to-DC conversion with bipolar input signal range 
US-6359576-B1
Linear Technology Corporation
2002-03-19
https://patents.google.com/patent/US6359576B1/en
BACKGROUND OF THE INVENTION
The present invention relates to apparatus and methods for providing an output signal proportional to the root-mean-square (RMS) value of an input signal. More particularly, the present invention relates to apparatus and methods for providing an output signal proportional to the RMS value of an input signal having a bipolar signal range. The output signal may be a continuous-time direct current (DC) signal proportional to the RMS value of an input signal (commonly called RMS-to-DC conversion), or may be a digital signal that has a value that is proportional to the RMS value of an input signal.
The RMS value of a waveform is a measure of the heating potential of the waveform. RMS measurements allow the magnitudes of all types of voltage (or current) waveforms to be compared to one another. Thus, for example, an alternating current (AC) waveform having a value of 1 volt RMS produces the same amount of heat in a resistor as a 1 volt DC voltage.
Mathematically, the RMS value of a signal V is defined as:


 V rms ={square root over ({overscore (V2+L )})}ââ(1)


which involves squaring the signal V, computing the average value (represented by the overbar in equation (1)), and then determining the square root of the result.
Various previously known techniques have been used to measure RMS values. In one previously known technique, an applied signal is converted to heat, and a DC output signal is generated that has the same heat potential as the applied signal. For example, the LT1088 Wideband RMS-DC Converter Building Block (LT1088), from Linear Technology Corporation, Milpitas, Calif., may be used with external circuitry (e.g., two matched resistors and an opamp) to provide a thermally-based RMS-to-DC converter circuit. In particular, the LT-1088 includes a first heater having first and second terminals thermally coupled to a first temperature sensing diode, and a second heater having first and second terminals thermally coupled to a second temperature sensing diode. The first heater and first temperature sensing diode are thermally isolated from the second heater and second temperature sensing diode.
An RMS-to-DC converter circuit may be provided using the LT-1088 by coupling: (1) an input signal to the first terminal of the first heater; (2) the second terminals of the first and second heaters and the cathode terminals of the first and second temperature sensing diodes to GROUND; (3) the anode terminal of the first temperature sensing diode to an inverting input of an external opamp and through a first external resistor to a positive power supply (e.g., V+); (4) the anode terminal of the second temperature sensing diode to a non-inverting input of the external opamp and through a second external resistor to V+; and (5) the output of the external opamp to the first terminal of the second heater. The first heater converts the input signal to heat, and the second heater converts the output signal to heat. The external opamp provides a DC output signal having the same heat potential as the input signal.
Thermal techniques such as converter circuits that include the LT1088 provide an accurate result and provide a very high input signal bandwidth. The heaters and temperature sensitive diodes included on the LT1088, however, are sensitive to temperature gradients caused by other circuitry. Therefore, it is difficult to include other circuits (e.g., the opamp or the first and second resistors) on the same die as the circuit inside the LT1088, because the other circuitry would generate temperature gradients that would affect the temperature sensitive diodes. As a result, the LT1088 must be combined with external circuitry to form an RMS-to-DC converter circuit, and it is difficult to implement such thermally-based RMS-to-DC converter circuits on a single integrated circuit.
Another previously known technique for measuring RMS values utilizes the exponential current-voltage relationship of a forward-biased semiconductor junction, and commonly is referred to as log-antilog RMS-to-DC conversion. In particular, a transconductance circuit converts an input voltage to an input current, a first forward-biased semiconductor junction conducts the input current and produces a first voltage (proportional to the natural logarithm of the input current), a multiplier circuit doubles the first voltage (equivalent to squaring the input current), a lowpass filter provides a second voltage proportional to the average value of the first voltage, a divider circuit halves the second voltage (equivalent to taking the square-root of the averaged, squared input current), and the halved second voltage is applied across a second forward-biased semiconductor junction to produce an output current proportional to the square-root of the average of the squared input current.
Because the input to any logarithm computation must be positive, conventional log-antilog RMS-to-DC converter circuits require a preceding absolute value circuit to assure that the input current remains positive. Because the heating potential of a signal depends on the signal amplitude and not the signal polarity, the absolute value operation ideally does not alter the RMS value of the signal.
Log-antilog RMS-to-DC converters, however, have several disadvantages. First, the amplitude of the signals conducted by the forward-biased semiconductor junctions are much smaller than conventional signal levels. As a result, all errors caused by component tolerances, thermal drift, mechanical stress and other factors are enhanced. Second, an absolute value circuit is difficult to implement because the circuit typically contributes offset, polarity gain mismatch and frequency-dependent and amplitude-dependent errors. Third, actual forward-biased semiconductor junctions have current-voltage relationships that deviate from an ideal exponential relationship, and therefore further limit the accuracy of the RMS-to-DC converter circuit.
Another known RMS-to-DC converter circuit is described in U.S. Pat. No. 5,896,056 to Glucina, the disclosure of which is incorporated by reference in its entirety. FIG. 1 illustrates an exemplary embodiment of Glucina's RMS-to-DC converter circuits. In particular, circuit 10 includes rectifier 12, modulator 14, demodulator 16, lowpass filter 18, and optional gain stages 20 and 22. Gain stage 20 has a gain A and gain stage 22 has a gain B. Gain stages 20 and 22 may be included together, included individually, or omitted entirely from circuit 10. Rectifier 12 is coupled to input signal VIN and provides rectified output signal VY. VIN is a bipolar signal, i.e., VIN has an instantaneous magnitude that may be positive or negative. Rectifier 12 converts VIN to time-varying signal VY that is a monopolar signal, i.e., VY has an instantaneous magnitude that is only positive or only negative. VY ideally is the instantaneous absolute value of VIN, and the RMS value of VY ideally equals the RMS value of VIN:


{square root over ({overscore (V IN 2+L )})}={square root over ({overscore (V Y 2+L )})}ââ(2)


where {overscore (VIN 2 +L )} is the mean value of VIN 2, and {overscore (VY 2 +L )} is the mean value of VY 2.
Modulator 14 is a pulse code modulator that has a monopolar input signal range and has an input terminal coupled to VY, a reference terminal coupled to the output of gain stage 22, and an output terminal that provides pulse code modulated (PCM) output signal D having a duty ratio equal to the ratio of VY to BÃVOUT:       D =   V Y   B Ã  V OUT        ( 3 )            
An example of a pulse modulator used to implement a division function is described, for example, by Dan Harres, âPulse Modulated Divider Suits Multichannel Systems,â EDN, Mar. 15, 1990 (hereinafter referred to as âHarresâ). An implementation of a division function using a pulse modulator also is described in more detail below.
PCM output signal D may, for example, comprise a stream of binary pulses, wherein each pulse is a binary signal (e.g., a digital signal having values LOW and HIGH) having a fixed pulse period. The duty ratio over a predetermined interval (e.g., 10 pulse periods) equals the ratio of the number pulses having a value HIGH during that interval to the total number of pulse periods during that interval. Thus, for example, if a pulse stream contains 4 pulses having a value HIGH during an interval of 10 pulse periods, the duty ratio equals 4/10=40%.
For high accuracy, modulator 14 may be implemented using an oversampling Î-Î£ pulse code modulator, as is known in the art. Î-Î£ modulators advantageously provide inherently good linearity and accuracy that is set by over-sampling ratios. For example, with an over-sampling ratio of 2000:1, a first-order Î-Î£ modulator has a signal-to-noise ratio that approaches 90 dB. Î-Î£ modulators, however, also have imperfections called limit cycles and idle tones that degrade performance.
Demodulator 16 has a monopolar input signal range and has an input terminal coupled to VY, a control terminal coupled to modulator output signal D, and an output terminal that provides demodulator output signal VX that is proportional to the product of VY and the duty ratio of PCM output signal D. In particular. demodulator 16 may comprise a switch that âchopsâ VY at a rate controlled by PCM output signal D. As a result, demodulator output signal VX has a magnitude equal to the product of VY and D:        V X  =   D Ã  V Y   =     V Y   B Ã  V OUT    Ã  V Y   =   V Y 2   B Ã  V OUT          ( 4 )            
An example of such a demodulator circuit is described in Harres.
The duty ratio of PCM output signal D must be within the range 0% to 100%. Because the duty ratio of D is proportional to the ratio of VY to VOUT, and because VOUT must be positive, the lower limit (i.e., D=0%) requires that VY must be greater than or equal to zero. The upper limit (i.e., D=100%) requires that the peak magnitude of VY not exceed BÃVOUT.
Lowpass filter 18 has a monopolar input signal range and provides output VZ equal to the time average of input signal VX. Lowpass filter 18 has a narrow passband, such that VZ is a quasi-static DC voltage that may be expressed as:        V z  =  AVG î¢  â  î¢  (   V Y 2   B Ã  V OUT    )       ( 5 )            
where AVG represents the time average.
Output signal VOUT equals:        V OUT  =   A Ã  V z   =  A Ã AVG î¢  â  î¢  (   V Y 2   B Ã  V OUT    )        ( 6 )            
Because VZ is a quasi-static DC value, VOUT also is a quasi-static DC value that has a time average approximately equal to VOUT. As a result, equation (6) can be written as:        V OUT  =   A B  Ã    V Y 2  _   V OUT        ( 7 )            
where VY 2 is the time-average of VY 2. Equation (7) may be re-written as:


 V OUT 2 =A/BÃ{overscore (VY 2+L )}ââ(8)


According, VOUT equals:        V OUT  =     A B   Ã    V Y 2  _    =    A B   Ã    V IN 2  _         (9a)       =    A B   Ã  V  R î¢  â  î¢ M î¢  â  î¢ S        (9b)            
The overall gain of circuit 10 equals VOUT/VRMS, which equals the square root of A/B.
Absolute value circuit 12 provides an output VY equal to the absolute value of input VIN, so that the input to modulator always is non-negative. Absolute value circuits, however, are difficult to implement and may impose gain errors and speed limitations that may degrade the performance of circuit 10, particularly the accuracy with which output VOUT of circuit 10 approximates the value shown in equation (9b).
In addition, circuit 10 is not easily implemented in integrated circuit form. In particular, if modulator 14 is a Î-Î£ modulator, the circuit is best implemented in complementary metal oxide semiconductor (CMOS) technology. Absolute value circuit 12, however, is best implemented in bipolar technology. Thus, it is difficult to fabricate circuit 10 as a single integrated circuit in a single technology.
Thus, to improve Glucina's circuits, it would be desirable to provide methods and apparatus for performing RMS-to-DC conversion of input signals having a bipolar signal range.
It also would be desirable to provide methods and apparatus for performing RMS-to-DC conversion that do not require a preceding absolute value circuit.
It also would be desirable to provide methods and apparatus for performing RMS-to-DC conversion with converter circuits that can be implemented using a single integrated circuit technology.
It still further would be desirable to provide methods and apparatus for performing RMS-to-DC conversion with converter circuits implemented using a CMOS technology.
It also would be desirable to provide methods and apparatus for performing RMS-to-DC conversion with converter circuits implemented using digital circuitry.
It still further would be desirable to provide methods and apparatus for performing RMS-to-DC conversion with converter circuits implemented using switched-capacitor circuitry.
It further would be desirable to provide methods and apparatus for performing RMS-to-DC conversion with converter circuits that include Î-Î£ modulators, but that reduce or eliminate limit cycles and idle tones.
SUMMARY OF THE INVENTION
Accordingly, it is an object of this invention to provide methods and apparatus for performing RMS-to-DC conversion of input signals having a bipolar signal range.
It also is an object of this invention to provide methods and apparatus for performing RMS-to-DC conversion that do not require a preceding absolute value circuit.
It also is an object of this invention to provide methods and apparatus for performing RMS-to-DC conversion with converter circuits that can be implemented using a single integrated circuit technology.
It still further is an object of this invention to provide methods and apparatus for performing RMS-to-DC conversion with converter circuits implemented using a CMOS technology.
It also is an object of this invention to provide methods and apparatus for performing RMS-to-DC conversion with converter circuits implemented using digital circuitry.
It further is an object of this invention to provide methods and apparatus for performing RMS-to-DC conversion with converter circuits implemented using switched-capacitor circuitry.
It further is an object of this invention to provide methods and apparatus for performing RMS-to-DC conversion with converter circuits that include Î-Î£ modulators, but that reduce or eliminate limit cycles and idle tones.
In accordance with these and other objects of the present invention, converter circuits in accordance with this invention include a pulse modulator and a demodulator each having a bipolar input signal range. The pulse modulator may be any commonly known pulse modulator, such as a pulse code modulator, pulse width modulator, or other similar modulator. Preferably, the pulse modulator is a single-bit oversampling Î-Î£ pulse code modulator. If the modulator is a Î-Î£ pulse code modulator, the demodulator may be implemented using a multiplying digital-to-analog converter.
Converter circuits in accordance with this invention may include first and second gain stages, the first gain stage provided in an input signal path of the pulse modulator, the second gain stage provided in an input or output signal path of the demodulator, the first and second gain stages providing first and second gains, respectively, the first and second gains selected so that the overall gain of the converter substantially is unity (1.0) or other integer value. In addition, the modulator may be a Î-Î£ modulator and the first and second gains may be selected to minimize idle tones and limit cycles in the modulator.
Converter circuits in accordance with this invention may be implemented on a single integrated circuit, using continuous-time, switched-capacitor, or digital circuitry, or using combinations of such circuitry. In particular, converter circuits of this invention may be implemented using switched-capacitor CMOS technology.
BRIEF DESCRIPTION OF THE DRAWINGS
The above-mentioned objects and features of the present invention can be more clearly understood from the following detailed description considered in conjunction with the following drawings, in which the same reference numerals denote the same structural elements throughout, and in which:
FIG. 1 is a schematic diagram of a previously known RMS-to-DC converter circuit;
FIG. 2A is a schematic diagram of an RMS-to-DC converter circuit of the present invention;
FIG. 2B is another schematic diagram of an RMS-to-DC converter circuit of the present invention;
FIG. 3 is another schematic diagram of an RMS-to-DC converter circuit of the present invention;
FIG. 4 is a simplified schematic diagram of the RMS-to-DC converter circuit of FIG. 2;
FIG. 5 is an alternative schematic diagram of the RMS-to-DC converter circuit of FIG. 4;
FIG. 6 is another alternative schematic diagram of the RMS-to-DC converter circuit of FIG. 4;
FIG. 7 is another alternative schematic diagram of the RMS-to-DC converter circuit of FIG. 4;
FIG. 8 is another alternative schematic diagram of the RMS-to-DC converter circuit of FIG. 4;
FIG. 9 is another alternative schematic diagram of the RMS-to-DC converter circuit of FIG. 4;
FIG. 10 is a schematic diagram of a differential RMS-to-DC converter circuit of the present invention;
FIG. 11 is a schematic diagram of a matched-delay RMS-to-DC converter circuit of the present invention;
FIG. 12 is a schematic diagram of an RMS-to-DC converter circuit of the present invention including cascaded Î-Î£ modulators;
FIG. 13 is another schematic diagram of an RMS-to-DC converter circuit of the present invention including cascaded Î-Î£ modulators;
FIG. 14 is another schematic diagram of an RMS-to-DC converter circuit of the present invention including cascaded Î-Î£ modulators;
FIG. 15 is a schematic diagram of an RMS-to-DC converter circuit of the present invention using digital circuitry;
FIG. 16 is a more detailed schematic diagram of the RMS-to-DC converter circuit of FIG. 15;
FIG. 17 is a schematic diagram of an illustrative accumulator circuit of the RMS-to-DC converter circuit of FIG. 16; and
FIG. 18 is a schematic diagram of an alternative embodiment of the RMS-to-DC converter circuit of FIG. 16.
DETAILED DESCRIPTION OF THE INVENTION
The present invention improves upon Glucina's RMS-to-DC converter circuits. In particular, converter circuits constructed in accordance with the present invention have a bipolar input signal range and do not require an absolute value circuit that precedes the converter. In addition, the overall gain of the converter circuits may be set substantially equal to unity (1.0) or some other integer value, and may be set to values that minimize errors in converter circuits implemented using Î-Î£ pulse code modulators. RMS-to-DC converter circuits in accordance with this invention may be implemented in single-ended or differential circuitry, using continuous-time and/or switched-capacitor circuitry. Alternatively, RMS-to-DC converter circuits in accordance with this invention may be implemented using digital circuitry.
First, the specification describes an improvement to Glucina's circuit that permits a bipolar input signal range without an absolute value circuit. Second, the specification describes how the gain stages may be configured to permit an accurate overall gain substantially equal to unity (1.0) or some other integer value. Third, the specification describes various alternative embodiments, including converters that use differential circuitry, delay-compensation and cascaded Î-Î£ modulators. Finally, the specification describes fully digital circuit implementations.
Referring to FIG. 2A, an illustrative embodiment of an RMS-to-DC converter circuit in accordance with the present invention is described. Circuit 30 includes pulse modulator 32, demodulator 34, gain stage 36, gain stage 38 and lowpass filter 54. Pulse modulator 32 has a first input coupled to VIN, a second input coupled to the output of gain stage 38 and an output V1. Demodulator 34 has an input coupled to VIN, a control input coupled to V1, and an output V2. Gain stage 38 has an input coupled to VOUT, and provides a broadband gain B. Lowpass filter 54 has an input coupled to V2 and an output V3 coupled to the input of gain stage 36. Gain stage 36 has an output VOUT, and provides a broadband gain A.
To simplify the description of pulse modulator 32 and demodulator 34, the following discussion first assumes that A=B=1. As described below, this assumption only affects a scale factor in the resulting analysis. Pulse modulator 32 may be any commonly known pulse modulator, such as a pulse code modulator, pulse width modulator, or other similar modulator. As shown in FIG. 2A, pulse modulator 32 preferably is implemented as a single-bit oversampling Î-Î£ pulse code modulator, and includes integrator 40, comparator 41, switch 42, non-inverting buffer 44 and inverting buffer 46. As described in more detail below, switch 42 and buffers 44 and 46 form a single-bit multiplying digital-to-analog converter (MDAC) 47.
Integrator 40 has a first input coupled to input VIN, a second input coupled to the pole of switch 42, and an output coupled to an input of comparator 41. Comparator 41 has a clock input coupled to clock signal CLK, and an output V1 coupled to control terminals of switches 42 and 52. Clock CLK is a fixed period clock that has a frequency that is much higher than the frequency of input VIN (e.g., 100 times greater). Comparator 41 compares the signal at the output of integrator 40 to a reference level (e.g., GROUND), and latches the comparison result as output signal V1 on an edge of clock CLK.
Non-inverting buffer 44 provides unity gain (i.e., +1.0) and has an input coupled to the output of gain stage 38, and an output coupled to the first terminal of switch 42. Inverting buffer 46 provides inverting gain (i.e., â1.0) and has an input coupled to the output of gain stage 38, and an output coupled to the second terminal of switch 42.
V1 is a signal having a binary output level (e.g., â1 or +1). If V1=â1, the pole of switch 42 is coupled to the output of non-inverting buffer 44. That is, (assuming gain B=1) +VOUT is coupled to the second input of integrator 40. Alternatively, if V1=+1, the pole of switch 42 is coupled to the output of inverting buffer 46. That is, (assuming gain B=1) âVOUT is coupled to the second input of integrator 40. This switching configuration provides negative feedback in pulse modulator 32.
The first and second inputs of integrator 40 therefore can have values equal to:


 âV OUT â¦V IN â¦V OUTââ(10)


and VIN thus has a bipolar input signal range without requiring an absolute value circuit.
From equation (10), if V1 has a duty ratio Dâ³ between 0-100%, Dâ³ can be expressed as:         D â²â²  =   1 2  Ã  (   V IN   V OUT   )    ,  0 â¤  D â²â²  â¤ 1      ( 11 )            
That is, if VIN=âVOUT, Dâ³=0, and if VIN=+VOUT, Dâ³=1.
Demodulator 34 includes non-inverting buffer 48, inverting buffer 50 and switch 52, which form a single-bit MDAC. Non-inverting buffer 48 has an input coupled to VIN, and an output coupled to a first terminal of switch 52. Inverting buffer 50 has an input coupled to VIN, and an output coupled to a second terminal of switch 52. Switch 52 has a control terminal coupled to V1 and a pole coupled to the input of lowpass filter 54.
If V1=+1, the pole of switch 52 is coupled to the output of non-inverting buffer 48. That is, +VIN is coupled to the input of lowpass filter 54. Alternatively, if V1=â1, the pole of switch 52 is coupled to the output of inverting buffer 50. That is, âVIN is coupled to the input of lowpass filter 54.
Demodulator 34 provides an output signal V2 at the pole of switch 52 that may be expressed as:        V 2  =    +  V IN   Ã  D â²â²   -   (  V IN  )  Ã  (   D â²â²  - 1  )        (12a)       =   V IN  Ã  (   2 Ã  D â²â²   - 1  )       (12b)            
Substituting equation (11) into equation (12b), V2 is given by:        V 2  =   V IN 2   V OUT       ( 13 )            
Lowpass filter 54 may be a continuous-time or a discrete-time filter, and provides an output V3 equal to the time average of input V2. Accordingly, V3 equals:        V 3  =    V IN 2  _   V OUT       ( 14 )            
Gain stage 36 provides an output VOUT equal to (assuming gain A=1) V3:        V OUT  =    V IN 2  _   V OUT       (15a)       =     V IN 2  _   =  V  R î¢  â  î¢ M î¢  â  î¢ S        (15b)            
Thus, circuit 30 has a bipolar input range and provides an output VOUT equal to the RMS value of input VIN.
Demodulator 34 and stage 47 each are single-bit MDACs and comparator 41 is a single-bit analog-to-digital converter (ADC) that provides a single-bit output V1. The difference between the output of integrator 40 and MDAC 47 equals the quantization error e[i] of pulse modulator 32.
As described above, pulse modulator 32 preferably is a single-bit oversampling Î-Î£ pulse code modulator. Pulse modulator 32 alternatively may be implemented using other pulse modulators. As shown in FIG. 2B, RMS-to-DC converter 30â² includes pulse width modulator 32â², which includes comparator 33 and sawtooth generator 35. Comparator 33 has a first input coupled to VIN, a second input coupled to the output of sawtooth generator 35, and provides pulse width modulated output V1PWM. Sawtooth generator 35 has an input coupled to the output of gain stage 38, and provides a sawtooth output having a fixed frequency much higher than the frequency of input VIN (e.g., 100 times greater), and maximum and minimum peak amplitudes of (assuming gain B=1) +VOUT and âVOUT, respectively.
Comparator 33 compares VIN to the signal at the output of sawtooth generator 35, and provides pulse width modulated output signal V1PWM, which is a signal having a binary output level (e.g., â1 or +1), and a duty cycle given by equation 11, above. In all other respects, circuit 30â² operates similarly to circuit 30, except that input signal VIN to circuit 30â² must be a continuous time signal.
To obtain lower quantization error, RMS-to-DC converters in accordance with the present invention also may be implemented using multibit stages, as shown in FIG. 3. Circuit 130 includes pulse modulator 132 and demodulator 134. Pulse modulator 132 is an N-bit oversampling Î-Î£ pulse code modulator that includes integrator 40, N-bit ADC 141 and N-bit MDAC 147, and that provides N-bit output V1M. Demodulator 134 is an N-bit MDAC. Circuit 30 of FIG. 2 is equivalent to circuit 130 of FIG. 3 with N=1.
The difference between the output of integrator 40 and MDAC 147 equals the quantization error eM[i] of pulse modulator 132. Multibit implementations such as the circuit shown in FIG. 3 achieve lower quantization error than the single-bit implementation of FIG. 2, but require more complex circuitry.
Referring now to FIG. 4, the gain scaling of the RMS-to-DC converter circuit 30 is described. To simplify the analysis, FIG. 4 depicts pulse modulator 32 as an ideal divider circuit and demodulator 34 as an ideal multiplier. VOUT can be written as:        V OUT  =    A B   Ã    V IN 2  _        (16a)        â  î¢  =    A B   Ã  V  R î¢  â  î¢ M î¢  â  î¢ S         (16b)            
By setting A=B, the overall gain of circuit 30 substantially equals unity (1.0). Alternatively, the overall gain of circuit 30 may be set substantially equal to another integer value by setting the ratio A/B equal to an integer squared. If circuit 30 is implemented in integrated circuit technology, the ratio of gains A and B may be very closely matched to provide a very accurate overall gain.
Because the maximum duty ratio of V1 cannot exceed 100%, the peak magnitude VPEAK of input signal VIN must satisfy the following relation:


 V PEAK â¦BÃV OUTââ(17)


Combining equations (16b) and (17),


 V PEAK â¦{square root over (AÃB)}ÃV RMSââ(18)


The ratio of the peak-to-RMS value of a time-varying waveform is the crest factor. From equation (18), the crest factor limit for circuit 30 equals:        Crest î¢  â  î¢ Factor î¢  â  î¢ Limit  =    V PEAK   V  R î¢  â  î¢ M î¢  â  î¢ S    â¤   A Ã B        ( 19 )            
Thus, the crest factor limit can be adjusted while maintaining a substantially unity (or other integer-valued) overall gain.
The broadband gain stages may be placed at various locations within RMS-to-DC converters of the present invention. In particular, as shown in FIGS. 4-9, gains stage 36 may be placed in various locations in an input or output signal path of demodulator 34, and gain stage 38 (or gain stage 62) may be placed in various locations in an input signal path of modulator 32. Each of FIGS. 4-9 illustrate circuits that provide an output signal VOUT as described in equation (16b) and have a crest factor limitation as described by equation (19). In FIGS. 7-9, gain stage 62 has a broadband gain 1/B.
In the embodiment shown in FIG. 4, the input signals to gain stages 36 and 38 are quasi-static DC signals. As a result, the gain-bandwidth requirements of amplifier circuits used to implement gain stages 36 and 38 may be relaxed compared to embodiments in which the input signals to the gain stages include higher frequency components. In addition, if gain stages 36 and 38 in FIG. 4 are implemented using switched-capacitor circuits that include auto-zero techniques, gain stages 36 and 38 may achieve very high accuracy.
If pulse modulator 32 is implemented as a Î-Î£ modulator, the ratio of VIN to VOUT preferably should be substantially irrational to minimize limit cycles and idle tones, as described, for example, in Steven R. Norsworthy et al., âDelta-Sigma Data Converters,â IEEE Press, pp. 80-104, 1997. Accordingly, gain B (or 1/B) may be set substantially to an irrational number. To maintain an overall gain of substantially unity, gain A should be set substantially equal to B. If circuit 30 is implemented as a single integrated circuit, gains A and B may be set using ratioed circuit elements (e.g., capacitors or resistors) having large-valued prime numbers.
For example, RMS-to-DC converter circuits of this invention may be implemented with switched capacitor techniques on a single integrated circuit, and gain stages 36 and 38 (or 62) each may be implemented using switched-capacitor circuits having gain-setting capacitors whose ratio is 283 to 67 (i.e., a ratio of 4.2239 . . . ). As a result of manufacturing tolerances, the absolute value of each capacitor, and the resulting capacitor ratio, will vary by a sufficiently random amount to minimize limit cycles and idle tones. Nevertheless, with commonly-used integrated circuit layout techniques, the ratio of A and B can be made to match very closely.
FIG. 10 illustrates a differential embodiment of an RMS-to-DC converter circuit in accordance with the present invention. Circuit 230 includes pulse modulator 232, demodulator 234, gain stage 236, gain stage 238 and lowpass filter 254. Circuit 230 receives differential inputs VINP and VINN and provides differential outputs VOUTP and VOUTN.
Pulse modulator 232 may be any commonly known pulse modulator, such as a pulse code modulator, pulse width modulator, or other similar modulator. As shown in FIG. 10, pulse modulator 232 preferably is implemented as a single-bit oversampling Î-Î£ pulse code modulator, and includes integrator 240, comparator 241 and crosspoint switch 242.
Integrator 240 has first differential inputs IP1 and IN2 coupled to inputs VINP and VINN, respectively, second differential inputs IP2 and IN2 coupled to differential outputs of crosspoint switch 242, and differential outputs coupled to differential inputs of comparator 241. Comparator 241 has an output V12 coupled to control terminals of crosspoint switches 242 and 252. Crosspoint switch 242 has differential inputs coupled to differential outputs of gain stage 238, and differential outputs coupled to second differential inputs IP2 and IN2 of integrator 240. Gain stage 238 has differential inputs coupled to VOUTP and VOUTN, and provides broadband gain B.
V12 is a signal having a binary output level (e.g., â1 or +1). If V12=â1, the differential outputs of gain stage 238 are coupled without inversion to second differential inputs IP2 and IN2 of Î-Î£ stage 240. That is, (assuming gain B=1) VOUTP is coupled to IP2 and VOUTN is coupled to IN2. Alternatively, if V12=+1, the differential outputs of gain stage 238 are coupled with inversion to second differential inputs IP2 and IN2 of Î-Î£ stage 240. That is, (assuming gain B=1) VOUTN is coupled to IP2 and VOUTP is coupled to IN2.
Demodulator 234 comprises crosspoint switch 252 having differential inputs coupled to inputs VINP and VINN, differential outputs coupled to differential inputs V2P and V2N of lowpass filter 254, and a control terminal coupled to V12. Lowpass filter 254 has differential outputs V3P and V3N coupled to differential inputs of gain stage 236. Gain stage 236 has differential outputs VOUTP and VOUTN, and provides broadband gain A. If V12=+1, differential inputs VINP and VINN are coupled without inversion to differential inputs V2P and V2N of lowpass filter 254. That is, VINP is coupled to V2P and VINN is coupled to V2N. Alternatively, if V12=â1, differential inputs VINP and VINN are coupled with inversion to differential inputs V2P and V2N of lowpass filter 254. That is, VINN is coupled to V2P and VINP is coupled to V2N.
Demodulator 234 provides differential outputs V2P and V2N given by (assuming gain B=1):        V  2 î¢ P   =   V  2 î¢ N   =    (   V INP  -  V INN   )  2   (   V OUTP  -  V OUTN   )        ( 20 )            
Lowpass filter 254 may be a continuous-time or a discrete-time filter, and provides differential outputs V3P and V3N equal to (assuming gain B=1):         V  3 î¢ P   -  V  3 î¢ N    =     (   V INP  -  V INN   )  2  _   (   V OUTP  -  V OUTN   )       ( 21 )            
Gain stage 236 provides an output (VOUTPâVOUTN) equal to (V3PâV3N) (assuming gain A=1):        (   V OUTP  -  V OUTN   )  =     (   V INP  -  V INN   )  2  _   (   V OUTP  -  V OUTN   )       (22a)        â  î¢  =     (   V INP  -  V INN   )  2  _        (22b)            
Thus, circuit 230 provides a differential output (VOUTPâVOUTN) equal to the RMS value of differential input (VINPâVINN). As with single-ended circuit 30, gain stages 236 and 238 may be placed at various locations within differential circuit 230 with equivalent results and crest factor limitations. In addition, lowpass filter 254 and/or gain stage 236 may have differential inputs and provide a single-ended output. In such an embodiment, output VOUTN is tied to a reference (e.g., GROUND).
Modulators 32, 132, and 232 of FIGS. 2-10 may introduce delay between modulator output V1 (or V1M or V12) and input VIN (or VINP and VINN). This delay may affect the accuracy of output V2 (or V2P and V2N) of demodulators 34 (or 134 or 234). For example, referring again to circuit 30 of FIG. 4, output V2 of demodulator 34 may be expressed as:         V 2  î¢   ( t )   =    V IN  î¢   ( t )   Ã    V IN  î¢   (  t - Ï  )    B Ã  V OUT         ( 23 )            
where t represents time (continuous or discrete) and Ï is any delay introduced by modulator 32 (because VOUT is quasi-static, it has not been expressed in equation (23) as a function of time t). For non-zero values of Ï, VOUT has a bandwidth roll-off that may be undesirable for certain input signals.
To minimize the bandwidth rolloff effect, a delay stage can be introduced in the signal path between input VIN and demodulator 34 that has a delay that substantially equals the delay through modulator 32. As shown in FIG. 11, circuit 330 includes the same circuit blocks as circuit 30, but also includes delay stage 68 that introduces a delay Ï that substantially equals the delay introduced by modulator 32. For example, if pulse modulator 32 is implemented as a Î-Î£ converter, delay stage 68 may be implemented as a switched-capacitor delay stage whose delay substantially equals the delay through modulator 32. If modulator 32 is a first-order Î-Î£ converter, the delay in delay stage 68 equals a single clock period.
The output of a pulse code modulator includes the desired PCM output, plus an error term commonly called quantization noise. For Î-Î£ modulators, various techniques have been used to minimize the effect of quantization noise, including using second, third, and higher-order modulator loops that provide additional noise shaping and improved performance. RMS-to-DC converter circuits in accordance with the present invention may include such high-order Î-Î£ modulators.
Higher-order loops, however, also require frequency compensation, which causes undesirable frequency-dependent delay that is difficult to compensate using a stage such as delay stage 68. Additionally, higher-order loops have input signal range restrictions that may further limit the usefulness of the Î-Î£ modulator in an RMS-to-DC converter.
As an alternative to using higher-order modulator loops to improve modulator performance, circuits in accordance with the present invention instead may use cascaded Î-Î£ modulators. In particular, two Î-Î£ modulators may be used, in which the second modulator digitizes a measure of the quantization error of the first modulator. The output of the two modulators then can be combined to cancel the quantization noise of the first modulator. Such cascaded modulators ideally provide the performance of higher-order loops, but use simple Î-Î£ stages that are easy to compensate.
FIG. 12 illustrates an embodiment of RMS-to-DC converters of the present invention that includes cascaded Î-Î£ modulators. Circuit 430 includes pulse modulator 432, demodulator 434, gain stage 36, gain stage 38, lowpass filter 54 and optional delay-matching stage 82. To simplify the description of modulator 432 and demodulator 434, the following discussion assumes that A=B=1. This assumption only affects a scale factor in the resulting analysis.
Pulse modulator 432 includes cascaded Î-Î£ pulse code modulators. In particular, pulse modulator 432 includes Î-Î£ stages 72 and 76, delay stages 74 and 78 and subtractor 80. As described in more detail below, Î-Î£ stage 76, delay stage 78 and subtractor 80 provide an estimate of the spectrally-shaped quantization error of Î-Î£ stage 72.
Î-Î£ stage 72 has a first input coupled to VIN, a second input coupled to the output of gain stage 38, a first output coupled to the input of delay stage 74, and a second output V4 coupled to a first input of Î-Î£ stage 76. Î-Î£ stage 76 has a second input coupled to the output of gain stage 38, and an output V5 coupled to a non-inverting input of subtractor 80 and to an input of delay stage 78. Subtractor 80 has an inverting input coupled to an output of delay stage 78, and an output V1b coupled to a control terminal of switch 96. Delay stage 74 matches the delay through Î-Î£ stage 76, and has an output V1a coupled to a control terminal of switch 88.
Î-Î£ stages 72 and 76 each are, for example, single-bit modulators that can be of any order. Preferably, Î-Î£ stage 72 is a first-order stage. First-order Î-Î£ stage 72 and delay stage 74 provide output V1a equal to (assuming gain B=1):         V  1 î¢ a   î¢   [  i + 1  ]   =    (   V IN  î¢   [  i - 1  ]   )   V OUT   +   (   e î¢   [ i ]   -  e î¢   [  i - 1  ]    )   V OUT        ( 24 )            
where index i denotes the sample index and e[i] is the quantization error of Î-Î£ stage 72. V1a thus equals the desired ratio of the input divided by VOUT, plus the spectrally-shaped quantization error of Î-Î£ stage 72 divided by VOUT.
Î-Î£ stage 76, delay stage 78 and subtractor 80 provide an output V1b equal to an estimate of the spectrally-shaped quantization error of Î-Î£stage 72 divided by VOUT. In particular, V4 is the quantization error e[i] of Î-Î£ stage 72, which equals the difference between the integrator and MDAC outputs of Î-Î£ stage 72. Î-Î£ stage 76 provides an output V5 equal to (assuming gain B=1):         V 5  î¢   [  i + 1  ]   =   (  1  V OUT   )  Ã  [   e î¢   [ i ]   +  (    e â²  î¢   [  i + 1  ]   -   e â²  î¢   [ i ]    )   ]       ( 25 )            
where eâ²[i] is the quantization error of Î-Î£ stage 76. Delay stage 78 and subtractor 80 form a digital differentiator that provide an output V1b equal to (assuming gain B=1):         V  1 î¢ b   î¢   [  i + 1  ]   =   (  1  V OUT   )  Ã  [   e 1  +  e 2   ]       ( 26 )            
where


 e 1 =e[i]âe[iâ1]ââ(27a)




 e 2 =eâ²[i+1]â2eâ²[i]+eâ²[iâ1]ââ(27b)


Delay stage 82 matches the combined delay through Î-Î£ modulators 72 and 76. Demodulator 434 provides an output proportional to input VIN times the ratio of VIN to VOUT. In particular, demodulator 434 includes non-inverting buffer 84, inverting buffer 86, switch 88, subtractor 90, non-inverting buffer 92, inverting buffer 94, three-position switch 96 and multiply-by-two stage 97. Non-inverting buffer 84 provides unity gain (i.e., +1.0) and has an input coupled through delay stage 82 to input VIN, and an output coupled to the first terminal of switch 88. Inverting buffer 86 provides inverting gain (i.e., â1.0) and has an input coupled through delay stage 82 to input VIN, and an output coupled to the second terminal of switch 88. Non-inverting buffer 84, inverting buffer 86 and switch 88 form a single-bit MDAC.
V1a is a binary signal having a binary output level (e.g., â1 or +1). If V1a=+1, the pole of switch 88 is coupled to the output of non-inverting buffer 84. That is, +VIN is coupled to first input V6 of subtractor 90. Alternatively, if V1a=â1, the pole of switch 88 is coupled to the output of inverting buffer 86. That is, âVIN is coupled to first input V6 of subtractor 90. V6 equals (assuming gain B=1):         V 6  î¢   [  i + 1  ]   =     V IN  î¢   [  i - 1  ]    V OUT   Ã   V  1 î¢ a   î¢   [  i + 1  ]        (28a)        â  î¢  =     V IN  î¢   [  i - 1  ]    V OUT   Ã  (    V IN  î¢   [  i - 1  ]   +  e 1   )        (28b)            
Non-inverting buffer 92 provides unity gain (i.e., +1.0) and has an input coupled through delay stage 82 to input VIN, and an output coupled to the first terminal of three-position switch 96. Inverting buffer 86 provides inverting gain (i.e., â1.0) and has an input coupled through delay stage 82 to input VIN, and an output coupled to the third terminal of three-position switch 96. The second terminal of three-position switch 96 is coupled to GROUND. Non-inverting buffer 92, inverting buffer 94 and three-position switch 96 form a 1.5-bit MDAC. Multiply-by-two stage 97 provides a gain of +2.0.
V1b is a tri-level signal having output values of â2, 0 or +2. If V1b=+2, the pole of three-position switch 96 is coupled to the output of non-inverting buffer 92. That is, +2VIN is coupled to second input V7 of subtractor 90. If V1b=0, the pole of switch 96 is coupled to GROUND, and therefore 0 is coupled to second input V7 of subtractor 90. If, however, V1b=â2, the pole of switch 96 is coupled to the output of inverting buffer 94. That is, â2VIN is coupled to second input V7 of subtractor 90. V7 equals (assuming gain B=1):         V 7  î¢   [  i + 1  ]   =     V IN  î¢   [  i - 1  ]    V OUT   Ã  (   e 1  +  e 2   )       ( 29 )            
Subtractor 90 provides an output V8 that equals the difference between V6 and V7:         V 8  î¢   [  i + 1  ]   =    V 6  î¢   [  i + 1  ]   -   V 7  î¢   [  i + 1  ]        (30a)        â  î¢  =      V IN  î¢   [  i - 1  ]   2   V OUT   -    V IN   V OUT   Ã  e 2     î¢  â      (30b)            
Thus, V8 is proportional to VIN squared divided by VOUT, substantially without the quantization noise of Î-Î£ stage 72. The quantization noise e2 of Î-Î£ stage 76 remains, but the low frequency portion of that noise is further reduced by the spectral shaping provided by delay 78 and subtractor 80. Further, because e2 is uncorrelated with VIN, the DC average of the product of e2 and VIN equals zero. As a result, output V9 of lowpass filter 54 approximately equals:


 V 9 â{square root over ({overscore (VIN 2+L )})}ââ(31)


Output VOUT of gain stage 36 approximately equals (assuming gain A=1):


 V OUT â{square root over ({overscore (VIN 2+L )})}ââ(32)


The circuit of FIG. 12 may be implemented using single-ended or differential circuitry.
FIG. 13 shows another illustrative embodiment of RMS-to-DC converters of the present invention that include cascaded Î-Î£ modulators. Converter 530 includes single-sample delay stages 82 and 104, modulator 532 and demodulator 534. Modulator 532 includes single-bit Î-Î£ stages 72 and 76, and demodulator 534 includes single-bit MDAC stages 98, 100 and 102, and adder/subtractor 106. MDACS 98, 100 and 102 may be implemented as in demodulator 34 of FIG. 2 or demodulator 234 of FIG. 10. Alternatively, one or more of MDACS 98, 100 and 102 may be implemented as a single time-multiplexed MDAC.
Î-Î£ stage 72 provides a quantized output V1c equal to (assuming gain B=1):         V  1 î¢ c   î¢   [ i ]   =     V IN  î¢   [  i - 1  ]   +  e î¢   [ i ]   -  e î¢   [  i - 1  ]     V OUT       ( 33 )            
In addition, V4 equals the quantization error e[i] of Î-Î£ stage 72.
Î-Î£ stage 76 provides a quantized output V1d equal to (assuming gain B=1):         V  1 î¢ d   î¢   [ i ]   =    e î¢   [  i - 1  ]   +   e â²  î¢   [ i ]   -   e â²  î¢   [  i - 1  ]     V OUT       ( 34 )            
Single-bit DACs 98, 100 and 102 provide outputs V10, V11 and V12, respectively, equal to (assuming gain B=1):


 V 10 [i]=V IN [iâ1]ÃV 1c [i]ââ(35)




 V 11 [i]=V IN [iâ1]ÃV 1d [i]ââ(36)




 V 12 [i]=V IN [iâ2]ÃV 1d [i]ââ(37)


Adder/subtractor 106 provides an output V13 equal to:


 V 13 [i]=V 10 [i]+V 11 [i]âV 12 [i]ââ(38)


which equals (assuming gain B=1):            V 13  î¢   [ i ]   =  â  î¢      V IN  î¢   [  i - 1  ]    V OUT   Ã  (    V IN  î¢   [  i - 1  ]   +  e î¢   [ i ]   +   e â²  î¢   [ i ]   -   e â²  î¢   [  i - 1  ]    )   -         â  î¢     V IN  î¢   [  i - 2  ]    V OUT   Ã  (   e î¢   [  i - 1  ]   +   e â²  î¢   [ i ]   -   e â²  î¢   [  i - 1  ]    )          ( 39 )            
Note that:            V 13  î¢   [  i + 1  ]   =  â  î¢      V IN  î¢   [ i ]    V OUT   Ã  (    V IN  î¢   [ i ]   +  e î¢   [  i + 1  ]   +   e â²  î¢   [  i + 1  ]   -   e â²  î¢   [ i ]    )   -         â  î¢     V IN  î¢   [  i - 1  ]    V OUT   Ã  (   e î¢   [ i ]   +   e â²  î¢   [  i + 1  ]   -   e â²  î¢   [ i ]    )          ( 40 )            
If the time constant of lowpass filter 54 is much greater than the sample period of V13[i] (e.g., 10,000 times), lowpass filter 54 provides output V14 that is the average of sequence V13. V13 as a function of VIN[iâ1] approximately equals:        V 13  |    V IN  î¢   [  i - 1  ]   â      V IN  î¢   [  i - 1  ]    V OUT   Ã  (    V IN  î¢   [  i - 1  ]   +  e î¢   [ i ]   +   e â²  î¢   [ i ]   -   e â²  î¢   [  i - 1  ]    )   -     V IN  î¢   [  i - 1  ]    V OUT   Ã  (   e î¢   [ i ]   +   e â²  î¢   [  i + 1  ]   -   e â²  î¢   [ i ]    )         ( 41 )            
which may be written as:            V 13  |   V IN  î¢   [  i - 1  ]    =  â  î¢    (    V IN  î¢   [  i - 1  ]    V OUT   )  2  -         â  î¢     V IN  î¢   [  i - 1  ]   Ã  (    e â²  î¢   [  i + 1  ]   -  2 î¢   e â²  î¢   [ i ]    +   e â²  î¢   [  i - 1  ]    )    V OUT          ( 42 )            
The first term on the right side of equation (42) is the desired output, and the second term equals the second-order spectrally-shaped quantization noise of Î-Î£ stage 76, which is substantially reduced by lowpass filter 54. Further, because eâ² is uncorrelated with VIN, the DC average of the product of eâ² and VIN equals zero. As a result, V14 approximately equals:        V 14  =    V 13  _  â    V IN 2  _   V OUT        ( 43 )            
Output VOUT of gain stage 36 approximately equals (assuming gain A=1):


 V OUT â{square root over ({overscore (VIN 2+L )})}ââ(44)


The circuit of FIG. 13 may be implemented using single-ended or differential circuitry.
FIG. 14 illustrates another embodiment of RMS-to-DC converters of the present invention that include cascaded Î-Î£ modulators. Circuit 630 includes delay stages 82 and 104 and pulse modulator 632 and demodulator 634. Circuit 630 includes features of circuits 430 and 530, but substantially eliminates the effect of any DC offset that occurs in Î-Î£ stage 76 and delay stage 104.
Modulator 632 includes single-bit Î-Î£ stages 72 and 76, delay stage 78 and subtractor 80. Demodulator 634 includes 1-bit DAC 87, 1.5-bit DAC 89, subtractor 90 and multiply-by-two stage 97. Delay stage 82 matches the delay through Î-Î£ modulator 72 and delay stage 104 matches the delay through Î-Î£ modulator 76.
Î-Î£ stage 72 provides a quantized output V1e equal to (assuming gain B=1):         V  1 î¢ e   î¢   [ i ]   =     V IN  î¢   [  i - 1  ]   +  e î¢   [ i ]   -  e î¢   [  i - 1  ]     V OUT       ( 45 )            
Î-Î£ stage 76, delay stage 78 and subtractor 80 provide an output V1f equal to an estimate of the spectrally-shaped quantization error V4 of Î-Î£ stage 72 divided by VOUT. Î-Î£ stage 76 provides an output V15 equal to (assuming gain B=1):         V 15  î¢   [  i + 1  ]   =   (  1  V OUT   )  Ã  [   e î¢   [ i ]   +  (    e â²  î¢   [  i + 1  ]   -   e â²  î¢   [ i ]    )   ]       ( 46 )            
where eâ²[i] is the quantization error of Î-Î£ stage 76. Delay stage 78 and subtractor 80 form a digital differentiator that provide an output V1f equal to (assuming gain B=1):         V  1 î¢ f   î¢   [  i + 1  ]   =   (  1  V OUT   )  Ã  [   e 1  +  e 2   ]       ( 47 )            
where


 e 1 =e[i]âe[iâ1]ââ(48a)




 e 2 =eâ²[i+1]â2eâ²[i]+eâ²[iâ1]ââ(48b)


V16 equals (assuming gain B=1):         V 16  î¢   [ i ]   =     V IN  î¢   [  i - 1  ]    V OUT   Ã   V  1 î¢ e   î¢   [ i ]        (49a)        â  î¢  =     V IN  î¢   [  i - 1  ]    V OUT   Ã  (    V IN  î¢   [  i - 1  ]   +  e 1   )        (49b)            
V17 equals (assuming gain B=1):         V 17  î¢   [  i + 1  ]   =     V IN  î¢   [  i - 1  ]    V OUT   Ã  (   e 1  +  e 2   )       ( 50 )            
The digital differentiator formed by delay stage 78 and subtractor 80 has a zero at DC, and therefore sequence V1f substantially has no DC component. As a result, sequence V17 is substantially free of any DC offset introduced by delay stages 82 and 104, and Î-Î£ stage 76.
Subtractor 90 provides an output V18 that equals the difference between V16 and V17:         V 18  î¢   [  i + 1  ]   =    V 16  î¢   [ i ]   -   V 17  î¢   [  i + 1  ]        (51a)        â  î¢  =      V IN  î¢   [  i - 1  ]   2   V OUT   -    V IN   V OUT   Ã  e 2         (51b)            
Thus, V18 is proportional to VIN squared divided by VOUT, substantially without the quantization noise of Î-Î£ stage 72. Output V19 of lowpass filter 54 approximately equals:


 V 19 â{square root over ({overscore (VIN 2+L )})}ââ(52)


and output VOUT of gain stage 36 approximately equals (assuming gain A=1):


 V OUT â{square root over ({overscore (VIN 2+L )})}ââ(53)


The circuit of FIG. 14 may be implemented using single-ended or differential circuitry.
In addition to continuous-time and sampled-data implementations, RMS-to-DC converters in accordance with the present invention also may be implemented using digital signal processing techniques. Such implementations may be advantageous, for example, if the signal to be converted is available as a digital signal (e.g., following analog-to-digital conversion). FIG. 15 illustrates an exemplary digital circuit embodiment of RMS-to-DC converters in accordance with this invention.
Circuit 730 includes digital pulse modulator 732, digital demodulator 734, digital gain stages 736 and 738 and digital lowpass filter 754. Circuit 730 provides output signal VOUTD that is a digital number proportional to the RMS value of an input signal represented by the sequence of digital numbers VIND. VIND, for example, may be a multi-bit digital signal, such as a 10-bit digital signal (9 magnitude bits plus 1 sign bit).
Digital pulse modulator 732 has a first input coupled to VIND, a second input coupled to the output of digital gain stage 738 and an output V1D. Digital gain stage 738 has an input coupled to VOUTD, and provides broadband gain B. Digital gain stage 736 has an input coupled to VIND, and provides broadband gain A. Digital demodulator 734 has an input coupled to the output of digital gain stage 736, a control input coupled to V1D and an output V2D. Digital lowpass filter 754 has an input coupled to V2D and provides output VOUTD.
FIG. 16 illustrates a more detailed block diagram of the circuit of FIG. 15. Digital modulator 732 includes digital integrator 740, comparator 741 and exclusive-OR gate 747. Digital integrator 740 has a first input coupled to VIND, a second input coupled to the output of exclusive-OR gate 747, and an output coupled to a first input of comparator 741. Digital integrator 740, for example, may be a multi-bit integrator, and may receive at its first and second input signals 12-bit input signals (11 magnitude bits plus 1 sign bit), and may provide a 12-bit output (11 magnitude bits plus 1 sign bit).
Comparator 741 has a second input coupled to digital reference signal REF, and provides an output V1D. Comparator 741, for example, may be a multi-bit comparator, and may receive at its first input a 13-bit input signal (12 magnitude bits plus 1 sign bit). REF, for example, may be a digital signal that corresponds to 0 volts. Comparator 741 compares the signal at the first input with REF at its second input, and provides a 1-bit output V1D equal to the comparison result.
Exclusive-OR gate 747 has a first input coupled to V1D and a second input coupled to the output of digital gain stage 738. Exclusive-OR gate 747, for example, may be a multi-bit exclusive-OR gate, and may receive a 1-bit control signal V1D at its first input, a 12-bit input signal at its second input (11 magnitude bits plus 1 sign bit), and may provide a 12-bit output signal (11 magnitude bits plus 1 sign bit). If V1D is logic LOW (e.g., 0 volts), exclusive-OR gate 747 provides an output equal to the signal at its second input. If, however, V1D is logic HIGH (e.g., 5 volts), exclusive-OR gate 747 provides an output equal to the complement of the signal at its second input.
Digital integrator 740 includes digital adder 742 and accumulator 743. Digital adder 742 has a first input coupled to VIND, a second input coupled to the output of exclusive-OR gate 747, and an output coupled to the input of accumulator 743. Digital adder 742, for example, may be a multi-bit adder, and may receive a 10-bit input signal at its first input (9 magnitude bits plus 1 sign bit), a 12-bit input signal at its second input (11 magnitude bits plus 1 sign bit), and may provide a 12-bit output signal to accumulator 743.
Accumulator 743 has an output coupled to the first input of comparator 741. Accumulator 743, for example, may be a multi-bit accumulator, and may receive a 12-bit input signal (11 magnitude bits plus 1 sign bit) and may provide a 13 bit output signal (12 magnitude bits plus 1 sign bit) (as such, accumulator 743 commonly is referred to as a 13-bit accumulator). FIG. 17 illustrates an exemplary embodiment of accumulator 743, which includes digital adder 751 and register 752. Digital adder 751 has a first input 753, a second input coupled to output 755 of register 752, and an output 754. Register 752 includes sign bit 756.
Digital adder 751, for example, may be a multi-bit adder, and may receive 13 bit input signals at its first and second inputs (12 magnitude bits plus 1 sign bit), and may provide a 13 bit output signal (12 magnitude bits plus 1 sign bit). Register 752 has an input coupled to output 754 of digital adder 751, and a clock input coupled to clock signal CLK. On each pulse of clock signal CLK, output 755 equals the sum of first input 753 and the previous value of output 755. Register 752, for example, may be a multi-bit register, and may receive a 13-bit input signal (12 magnitude bits plus 1 sign bit), and may provide a 13-bit output signal (12 magnitude bits plus 1 sign bit).
Referring again to FIG. 16, to simplify the description of digital modulator 732 and digital demodulator 734, the following discussion assumes that A=B=1. This assumption only affects a scale factor in the resulting analysis. If V1D is LOW (assuming B=1), +VOUTD is coupled to the second input of integrator 740. Alternatively, if V1D is HIGH (assuming B=1), âVOUTD (in 1's complement logic) is coupled to the second input of integrator 740. (For 2's complement logic, V1D can be coupled to a carry-in input of adder 742). This configuration provides negative feedback in pulse modulator 732.
The first and second inputs of Î-Î£ stage 740 therefore can have values equal to:


 âV OUTD â¦V IND â¦+V OUTDââ(54)


and VIND thus has a bipolar input signal range without requiring an absolute value circuit.
From equation (54), if V1D has a duty ratio DD between 0-100%, DD can be expressed as:         D D  =   1 2  Ã  (    V IND   V OUTD   + 1  )    ,  0 â¤  D D  â¤ 1      ( 55 )            
That is, if VIND=âVOUTD, DD=0, and if VIND=+VOUTD, DD=1.
Digital demodulator 734 includes inverter 744 and exclusive-OR gate 745. Inverter 744 has an input coupled to output V1D and an output coupled to a first input of exclusive-OR gate 745. Exclusive-OR gate 745 has a second input coupled to the output of gain stage 736, and an output V2D coupled to the input of digital lowpass filter 754. Exclusive-OR gate 745, for example, may be a multi-bit exclusive-OR gate, and may receive a 1-bit control signal at its first input, a 10-bit input signal at its second input (9 magnitude bits plus 1 sign bit), and may provide a 10-bit output signal (9 magnitude bits-plus 1 sign bit).
If V1D is LOW, exclusive-OR gate 745 provides an output equal to the complement of the signal at its second input. If, however, V1D is HIGH, exclusive-OR gate 747 provides an output equal to the signal at its second input. Thus, if V1D is HIGH (and assuming C=1), output V2D=+VINDis coupled to the input of lowpass filter 754. Alternatively, if V1D is LOW, output V2D=âVIND is coupled to the input of lowpass filter 754.
V2D may be expressed as:        V  2 î¢ D   =    +  V IND   Ã  D D   -   (  -  V IND   )  Ã  (   D D  - 1  )        (56a)        â  î¢  =   V IND  Ã  (   2 Ã  D D   - 1  )        (56b)            
Substituting equation (55) into equation (56b), V2D is given by:        V  2 î¢ D   =   V IND 2   V OUTD       ( 57 )            
If REF is a digital signal equal to 0, V1D is HIGH if the output of accumulator 743 is greater than or equal to 0, and is LOW if the output of accumulator 743 is less than 0. Accordingly, if REF=0, the circuit of FIG. 16 can be simplified to the circuit shown in FIG. 18. Circuit 830 is similar to circuit 730, except that comparator 741 has been eliminated from digital modulator 832, inverter 744 has been eliminated from digital demodulator 834, and inverter 844 has been added to digital modulator 832. In addition, sign bit 756 of accumulator 743 is coupled directly to the first input of exclusive-OR gate 745 and to the input of inverter 844, and the output of inverter 844 is coupled to the first input of exclusive-OR gate 747.
If the value stored in output 755 of accumulator 743 (FIG. 17) is greater than or equal to zero, sign bit 756 of accumulator 743 is LOW. Otherwise, if the value stored in output 755 of accumulator 743 is less than zero, sign bit 756 of accumulator 743 is HIGH. Thus, sign bit 765 of accumulator 743 may be used as the complement {overscore (V1D+L )} of signal V1D.
Referring again to FIG. 16, digital lowpass filter 754 includes subtractor 746, accumulator 748, and gain stages 749 and 750. Subtractor 746 has a first input coupled to V2D, a second input coupled to the output of gain stage 749, and an output coupled to the input of accumulator 748. Accumulator 748 has an output coupled to the input of gain stage 749 and the input of gain stage 750. Accumulator 748, for example, may be a multi-bit accumulator, such as a 24-bit accumulator. Gain stage 750 has an output VOUTD, and gain stages 749 and 750 have gains of Î². Digital lowpass filter 754 has an output VOUTD that may be expressed as:


 V OUTD(n)=V OUTD(nâ1)+Î²[V 2D(nâ1)âV OUTD(nâ1)]ââ(58)


The z-domain transfer function H(z) of lowpass filter 754 is:        H î¢   ( z )   =  Î²  z -  (  1 - Î²  )        ( 59 )            
Gain Î² therefore may be used to set the corner frequency of lowpass filter 754. If Î² is a power of 2, (e.g., Î²=2âN), gain stages 749 and 750 may be implemented by shifting the binary point of the signal at the output of accumulator 748 left N bits.
Lowpass filter 754 provides an output VOUTD equal to the time average of input V2D. Accordingly, VOUTD equals:


 V OUTD ={square root over ({overscore (VIND 2+L )})}ââ(60)


Thus, circuit 730 (and circuit 830 in FIG. 18) has a bipolar input range and provides an output VOUTD equal to the RMS value of input VIND.
Gain stages 736 and 738 may be used to adjust the overall gain and crest factor limit for circuit 730 (and circuit 830 in FIG. 18). For non-unity values of A and B, VOUTD can be written as:        V OUTD  =   A Ã  V IND  Ã   V IND   B Ã  V OUTD     _      ( 61 )        â  î¢  =   A B  Ã    V IND 2  _   V OUTD         ( 62 )            
Therefore, VOUTD is given by:        V OUTD  =    A B   Ã    V IND 2  _        ( 63 )        â  î¢  =    A B   Ã  V  R î¢  â  î¢ M î¢  â  î¢ S         ( 64 )            
By setting A=B, the overall gain of circuit 730 substantially equals unity (1.0). Alternatively, the overall gain of circuit 730 may be set substantially equal to another integer value by setting the ratio A/B equal to an integer squared.
If gain value A equals a power of two (e.g., A=2K), gain stage 736 may be implemented by shifting the binary point of the signal at the second input of exclusive-OR gate 754 right K bits. Similarly, if gain value B equals a power of two (e.g., B=2M), gain stage 738 may be implemented by shifting the binary point of the signal at the second input of exclusive-OR gate 747 right M bits.
As with the embodiments of FIGS. 12-14, delay compensation can be added to digital embodiments of RMS-to-DC converters of this invention. For example, delay compensation can be added to the circuits of FIGS. 16 and 18 by adding a 1 clock-cycle delay stage before gain stage 736.
As an alternative to using digital circuits, RMS-to-DC converters of this invention may be implemented using a digital signal processor integrated circuit (e.g., the TMS320C25 digital signal processor manufactured by Texas Instruments, Inc., Dallas, Tex.) programmed to perform the modulation, demodulation and lowpass filtering operations described above.
Persons skilled in the art will recognize that the apparatus of the present invention may be implemented using circuit configurations other than those shown and discussed above. All such modifications are within the scope of the present invention, which is limited only by the claims that follow.